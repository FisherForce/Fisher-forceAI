<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Fisher-Force AI —</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
    @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
    .badge-ia { position: fixed; top: 15px; right: 15px; background: #00d4aa; color: white; padding: 8px 16px; border-radius: 50px; font-weight: bold; font-size: 13px; box-shadow: 0 3px 10px rgba(0,0,0,0.3); z-index: 9999; animation: pulse 2s infinite; }
    .live-badge { position: fixed; top: 15px; left: 15px; background: #00d4aa; color: white; padding: 10px 16px; border-radius: 50px; font-weight: bold; font-size: 14px; box-shadow: 0 4px 12px rgba(0,212,170,0.4); z-index: 9999; display: flex; align-items: center; gap: 8px; animation: pulse 2s infinite; }
    .live-dot { width: 10px; height: 10px; background: #fff; border-radius: 50%; animation: blink 1.5s infinite; }
    .dashboard { background: linear-gradient(135deg, #00d4aa, #00a085); color: white; padding: 18px; border-radius: 16px; margin: 20px 0; text-align: center; box-shadow: 0 8px 20px rgba(0,212,170,0.3); }
    .level-badge { background: #ffd700; color: #000; padding: 6px 14px; border-radius: 30px; font-weight: bold; }
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 12px; margin-top: 12px; }
    .stat-item { background: rgba(255,255,255,0.25); padding: 10px; border-radius: 10px; }
  </style>
</head>
<body>

  <div class="badge-ia">IA Apprenante</div>
  <div class="live-badge"><span class="live-dot"></span> IA en direct : <span id="patternCount">42</span> patterns appris</div>

  <header class="site-header">
    <div class="container">
      <h1>Fisher-Force AI</h1>
      <p class="tagline">La 1ère IA de pêche 100% Française</p>
    </div>
  </header>

  <main class="container main-grid">
    <section class="card input-card">
      <h2>Décris ton spot</h2>
      <label>Nom du spot <input id="spotName" placeholder="Ex: Étang du Moulin"></label>
      <label>Type d'eau<br><select id="waterType"><option>Étang</option><option>Rivière</option><option>Lac</option><option>Canal</option></select></label>
      <label>Fond / Structure <input id="structure" placeholder="Ex: herbiers, rochers"></label>
      <label>Espèce ciblée <input id="targetSpecies" placeholder="Ex: brochet, perche"></label>
      <label>Conditions <input id="conditions" placeholder="Ex: clair, pluie"></label>
      <label>Température (°C)<br><input type="number" id="temperature" placeholder="15"></label>

      <div style="margin-top:15px;">
        <button id="getAdvice">Obtenir des conseils</button>
        <button id="voiceBtn">Commande vocale</button>
        <button id="clearBtn">Réinitialiser</button>
      </div>
    </section>

    <section class="card output-card">
      <h2>Conseils de l'IA</h2>

      <!-- TABLEAU DE BORD XP (localStorage) -->
      <div class="dashboard">
        <h3><span class="level-badge" id="level">Débutant</span> — <span id="xp">0</span> XP</h3>
        <div class="stats-grid">
          <div class="stat-item">Spots : <strong id="spots">0</strong></div>
          <div class="stat-item">Prises : <strong id="success">0</strong></div>
          <div class="stat-item">Réussite : <strong id="rate">0%</strong></div>
        </div>
      </div>

      <div id="advice"><p class="muted">Remplis le formulaire puis clique sur "Obtenir des conseils".</p></div>

      <button onclick="openResultat()" style="margin:20px auto; display:block; width:90%; background:#00d4aa; color:white; border:none; padding:14px; border-radius:10px; font-weight:bold;">
        Enregistrer un résultat
      </button>

      <!-- CLASSEMENT MOCK -->
      <div style="margin:30px 0; text-align:center;">
        <h3 style="color:#00a085;">Top 5 des Maîtres</h3>
        <ol style="background:#f9f9f9; padding:20px; border-radius:10px; border:2px solid #00d4aa;">
          <li>LoulouPeche — 285 XP</li>
          <li>BrochetKiller — 220 XP</li>
          <li>PercheMaster — 190 XP</li>
          <li>Carpiste72 — 165 XP</li>
          <li>TruiteNinja — 140 XP</li>
        </ol>
      </div>
    </section>
  </main>

  <script src="app.js"></script>

  <!-- XP LOCAL + MISE À JOUR AUTO -->
  <script>
    // Charger XP
    const progress = JSON.parse(localStorage.getItem('fisherXP') || '{"xp":0,"spots":0,"success":0,"attempts":0}');
    document.getElementById('xp').textContent = progress.xp;
    document.getElementById('spots').textContent = progress.spots;
    document.getElementById('success').textContent = progress.success;
    document.getElementById('rate').textContent = progress.attempts ? Math.round(progress.success / progress.attempts * 100) + '%' : '0%';
    document.getElementById('level').textContent = progress.xp < 50 ? "Débutant" : progress.xp < 200 ? "Traqueur" : "Maître";

    // +5 XP depuis resultat.html
    window.addXP = function(success) {
      progress.xp += 5;
      progress.spots += 1;
      progress.attempts += 1;
      if (success) progress.success += 1;
      localStorage.setItem('fisherXP', JSON.stringify(progress));
      location.reload(); // refresh tableau
    };

    // Popup +5 XP
    window.showXPPop = function() {
      const pop = document.createElement('div');
      pop.textContent = '+5 XP !';
      pop.style.cssText = 'position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#00d4aa;color:white;padding:20px 40px;border-radius:20px;font-size:24px;font-weight:bold;z-index:10000;animation:xpPop 1s forwards;';
      document.body.appendChild(pop);
      setTimeout(() => pop.remove(), 1000);
    };
    const style = document.createElement('style');
    style.textContent = '@keyframes xpPop {0%{transform:scale(0)};50%{transform:scale(1.2)};100%{transform:scale(1);opacity:0;}}';
    document.head.appendChild(style);
  </script>
</body>
</html>
